# DocuMind - æ™ºèƒ½æ–‡æ¡£å¤§è„‘

DocuMind æ˜¯ä¸€ä¸ªå…¨æ ˆçš„ RAG (Retrieval-Augmented Generation) åº”ç”¨ç¨‹åºï¼Œå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ï¼ˆå¦‚ PDFï¼‰å¹¶åŸºäºæ–‡æ¡£å†…å®¹è¿›è¡Œæ™ºèƒ½å¯¹è¯ã€‚é¡¹ç›®é‡‡ç”¨ç°ä»£åŒ–çš„æŠ€æœ¯æ ˆï¼Œå‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œç»“åˆäº†é«˜æ€§èƒ½çš„å‘é‡æ£€ç´¢æœåŠ¡ã€‚

## ğŸŒŸ é¡¹ç›®äº®ç‚¹ä¸æŠ€æœ¯éš¾ç‚¹

### 1. ğŸ” **GitHub OAuth ç¬¬ä¸‰æ–¹ç™»å½•**
- **å®ç°**: é›†æˆäº† GitHub OAuth 2.0 è®¤è¯æµç¨‹ã€‚
- **éš¾ç‚¹**: å¤„ç† OAuth å›è°ƒã€äº¤æ¢ Access Tokenã€è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œå¹¶å°†å…¶ä¸æœ¬åœ° JWT è®¤è¯ä½“ç³»æ— ç¼èåˆï¼Œç¡®ä¿ç”¨æˆ·ä½“éªŒæµç•…ä¸”å®‰å…¨ã€‚

### 2. ğŸ“‚ **å¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼  (Large File Upload)**
- **å®ç°**: æ”¯æŒ GB çº§åˆ«çš„å¤§æ–‡ä»¶ä¸Šä¼ ã€‚
- **éš¾ç‚¹**: 
    - **åˆ†ç‰‡ç­–ç•¥**: å‰ç«¯å°†å¤§æ–‡ä»¶åˆ‡åˆ†ä¸º 2MB çš„å°å—å¹¶å‘ä¸Šä¼ ï¼Œåç«¯è´Ÿè´£æ¥æ”¶å¹¶æŒ‰åºåˆå¹¶ã€‚
    - **æ–­ç‚¹ç»­ä¼ **: åˆ©ç”¨æ–‡ä»¶ Hash æ£€æµ‹å·²ä¸Šä¼ çš„åˆ†ç‰‡ï¼Œç½‘ç»œä¸­æ–­ååªéœ€ä¸Šä¼ æœªå®Œæˆçš„éƒ¨åˆ†ï¼Œæå¤§åœ°æå‡äº†ä¸Šä¼ çš„å¯é æ€§ã€‚

### 3. ğŸ§µ **WebWorker å‰ç«¯è®¡ç®—ä¼˜åŒ–**
- **å®ç°**: åœ¨ WebWorker ä¸­è¿è¡Œè€—æ—¶çš„è®¡ç®—ä»»åŠ¡ã€‚
- **éš¾ç‚¹**: 
    - **ä¸»çº¿ç¨‹è§£è€¦**: ä¸ºäº†é¿å…å¤§æ–‡ä»¶è®¡ç®— Hash æ—¶é˜»å¡ UI æ¸²æŸ“ï¼ˆå¯¼è‡´é¡µé¢å¡é¡¿ï¼‰ï¼Œå°†è®¡ç®—å¯†é›†å‹çš„ MD5 Hash ä»»åŠ¡ç§»è‡³ WebWorker åå°çº¿ç¨‹è¿è¡Œã€‚
    - **é€šä¿¡æœºåˆ¶**: è®¾è®¡äº†é«˜æ•ˆçš„ä¸»çº¿ç¨‹ä¸ Worker ä¹‹é—´çš„æ¶ˆæ¯é€šä¿¡æœºåˆ¶ï¼Œå®æ—¶åé¦ˆè®¡ç®—è¿›åº¦ã€‚

### 4. ğŸ¨ **åŠ¨æ€ä¸»é¢˜é…è‰²åˆ‡æ¢**
- **å®ç°**: æ”¯æŒå®æ—¶åˆ‡æ¢åº”ç”¨çš„ä¸»é¢˜è‰²ï¼ˆPrimary Colorï¼‰å’Œæ·±è‰²/æµ…è‰²æ¨¡å¼ã€‚
- **éš¾ç‚¹**: 
    - **æ€§èƒ½ä¼˜åŒ–**: ä¸ºäº†é¿å…é¡µé¢åŠ è½½æ—¶çš„ "é—ªçƒ" (FOUC)ï¼Œé€šè¿‡ `theme.js` åœ¨ HTML è§£ææ—©æœŸæ³¨å…¥ CSS å˜é‡ï¼Œç»“åˆ `vite-plugin-pwa` å’Œå†…è”è„šæœ¬ä¼˜åŒ–é¦–å±æ¸²æŸ“æ€§èƒ½ã€‚
    - **å…¨å±€ä¸€è‡´æ€§**: ä½¿ç”¨ CSS Variables + Zustand å…¨å±€çŠ¶æ€ç®¡ç†ï¼Œç¡®ä¿æ‰€æœ‰ç»„ä»¶å’Œ Tailwind ç±»åèƒ½å³æ—¶å“åº”ä¸»é¢˜å˜åŒ–ã€‚

### 5. ğŸ§  **Python RAG å¾®æœåŠ¡è§£è€¦**
- **å®ç°**: å°† RAG æ ¸å¿ƒé€»è¾‘ï¼ˆPDF è§£æã€Embedding å‘é‡åŒ–ã€æ£€ç´¢ï¼‰å‰¥ç¦»ä¸ºç‹¬ç«‹çš„ Python FastAPI æœåŠ¡ã€‚
- **éš¾ç‚¹**: 
    - **å¼‚æ„é€šä¿¡**: Node.js åç«¯ä¸ Python æœåŠ¡ä¹‹é—´é€šè¿‡ HTTP è¿›è¡Œé«˜æ•ˆé€šä¿¡ã€‚
    - **æ€§èƒ½ç“¶é¢ˆ**: è§£å†³äº† Python åŒæ­¥é˜»å¡é—®é¢˜ï¼Œç§»é™¤äº† `async` å…³é”®å­—ä»¥åˆ©ç”¨çº¿ç¨‹æ± å¤„ç† CPU å¯†é›†å‹ä»»åŠ¡ï¼ˆå¦‚ PDF è§£æï¼‰ï¼Œå¹¶ä¼˜åŒ–äº†æ•°æ®åº“çš„å¹¶å‘å†™å…¥ç­–ç•¥ã€‚

### 6. ğŸŒŠ **å…¨é“¾è·¯æµå¼è¾“å‡º (Stream Output)**
- **å®ç°**: å®ç°äº†ç±»ä¼¼ ChatGPT çš„æ‰“å­—æœºæ•ˆæœã€‚
- **éš¾ç‚¹**: 
    - **SSE (Server-Sent Events)**: åç«¯é€šè¿‡ SSE åè®®å®æ—¶æ¨é€ LLM ç”Ÿæˆçš„ Tokenã€‚
    - **å‰ç«¯è§£æ**: å‰ç«¯è‡ªå®šä¹‰ Hook å¤„ç†æµå¼æ•°æ®ï¼Œå®æ—¶æ‹¼æ¥å¹¶æ¸²æŸ“ Markdownï¼ŒåŒæ—¶å¤„ç† RAG æ£€ç´¢åˆ°çš„â€œå‚è€ƒæ¥æºâ€æ•°æ®ï¼Œåšåˆ°äº†æ•°æ®ä¸ UI çš„å¹³æ»‘æ›´æ–°ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

é¡¹ç›®åŒ…å«ä¸‰ä¸ªä¸»è¦æœåŠ¡ï¼š

1.  **Client (`/client`)**: ç”¨æˆ·ç•Œé¢ï¼Œè´Ÿè´£èŠå¤©äº¤äº’ã€æ–‡ä»¶ä¸Šä¼ å’Œæ¸²æŸ“ Markdownã€‚
2.  **Server (`/server`)**: ä¸šåŠ¡ç½‘å…³ï¼Œå¤„ç†é‰´æƒã€æ–‡ä»¶å­˜å‚¨ã€èŠå¤©å†å²è®°å½•ï¼Œå¹¶è½¬å‘ RAG è¯·æ±‚ã€‚
3.  **RAG Service (`/rag-service`)**: æ ¸å¿ƒ AI æœåŠ¡ï¼Œè´Ÿè´£æ–‡æ¡£åµŒå…¥ (Embedding) å’Œå‘é‡æ£€ç´¢ (Retrieval)ã€‚

```mermaid
graph TD
    User[ç”¨æˆ·] --> Client
    Client -- HTTP/REST --> Server
    Server -- é‰´æƒ/ä¸šåŠ¡é€»è¾‘ --> Database[(Supabase)]
    Server -- æ£€ç´¢è¯·æ±‚ --> RAG_Service
    RAG_Service -- å‘é‡æŸ¥è¯¢ --> Database
    RAG_Service -- LLMè¯·æ±‚ --> OpenAI
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯ (Client)
- **æ¡†æ¶**: React 19, Vite 6
- **è¯­è¨€**: TypeScript
- **çŠ¶æ€ç®¡ç†**: Zustand
- **UI ç»„ä»¶**: Radix UI, Lucide React
- **æ ·å¼**: TailwindCSS v4
- **Markdown**: react-markdown, react-syntax-highlighter
- **HTTP**: Axios

### åç«¯ (Server)
- **è¿è¡Œç¯å¢ƒ**: Node.js
- **æ¡†æ¶**: Express v5
- **æ•°æ®åº“**: Supabase (PostgreSQL)
- **ORM/Query**: Supabase JS Client
- **è®¤è¯**: JWT (JSON Web Tokens)
- **æ–‡ä»¶å¤„ç†**: Multer

### AI æœåŠ¡ (RAG Service)
- **è¯­è¨€**: Python 3.10+
- **æ¡†æ¶**: FastAPI
- **AI/LLM**: OpenAI API
- **å‘é‡åº“**: Supabase (pgvector)

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡
ç¡®ä¿ä½ çš„æœ¬åœ°ç¯å¢ƒå·²å®‰è£…ï¼š
- Node.js (v18+)
- Python (v3.10+)
- PostgreSQL (æˆ–ç›´æ¥ä½¿ç”¨ Supabase è´¦å·)

### 2. æ•°æ®åº“è®¾ç½® (Supabase)
1.  åˆ›å»ºä¸€ä¸ª Supabase é¡¹ç›®ã€‚
2.  åœ¨ SQL ç¼–è¾‘å™¨ä¸­å¯ç”¨ `vector` æ‰©å±•ï¼š
    ```sql
    create extension if not exists vector;
    ```
3.  è¿è¡Œé¡¹ç›®ä¸­çš„è¿ç§»è„šæœ¬ï¼ˆå¦‚æœ‰ï¼‰ï¼Œç¡®ä¿åˆ›å»ºäº† `documents`, `messages`, `users` ç­‰è¡¨ï¼Œä»¥åŠå‘é‡ç´¢å¼•ã€‚
    *   å‚è€ƒ `server/migrations/optimize_indexes.sql` è¿›è¡Œç´¢å¼•ä¼˜åŒ–ã€‚

### 3. åç«¯æœåŠ¡ (Server)
```bash
cd server
npm install

# é…ç½®ç¯å¢ƒå˜é‡
# å¤åˆ¶ .env.example (å¦‚æœå­˜åœ¨) æˆ–æ–°å»º .env æ–‡ä»¶
# å¡«å†™: PORT=3000, SUPABASE_URL, SUPABASE_KEY, JWT_SECRET, OPENAI_API_KEY
```
å¯åŠ¨æœåŠ¡ï¼š
```bash
npm run dev
```

### 4. RAG æœåŠ¡ (Python)
```bash
cd rag-service

# åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
python -m venv .venv
# Windows:
..\.venv\Scripts\Activate.ps1
# Linux/Mac:
source .venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# é…ç½®ç¯å¢ƒå˜é‡ (.env)
# å¡«å†™: PORT=8000, OPENAI_API_KEY, SUPABASE_URL, SUPABASE_KEY
```
å¯åŠ¨æœåŠ¡ï¼š
```bash
python main.py
```

### 5. å‰ç«¯é¡¹ç›® (Client)
```bash
cd client
npm install

# é…ç½®ç¯å¢ƒå˜é‡ (.env)
# å¡«å†™: VITE_API_URL=http://localhost:3000
```
å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š
```bash
npm run dev
```

## ğŸ“ ç¯å¢ƒå˜é‡è¯´æ˜

å»ºè®®åœ¨å„ç›®å½•ä¸‹åˆ›å»º `.env` æ–‡ä»¶ï¼š

**Server (`server/.env`)**
```env
PORT=3000
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_anon_key
SERVICE_ROLE_KEY=your_service_role_key
JWT_SECRET=your_jwt_secret
OPENAI_API_KEY=sk-...
```

**RAG Service (`rag-service/.env`)**
```env
PORT=8000
OPENAI_API_KEY=sk-...
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_key
```

**Client (`client/.env`)**
```env
VITE_API_URL=http://localhost:3000/api
```

## ğŸ“‚ ç›®å½•ç»“æ„

```
chatLLM/
â”œâ”€â”€ client/          # React å‰ç«¯åº”ç”¨
â”œâ”€â”€ server/          # Node.js åç«¯åº”ç”¨
â”œâ”€â”€ rag-service/     # Python RAG å¾®æœåŠ¡
â””â”€â”€ README.md        # é¡¹ç›®æ–‡æ¡£
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

[MIT](LICENSE)
